# markdown 解析器

将markdown文件解析为类似dom树的结构

## 支持的markdown语法

### 行级标签
1. 标题 `# ##...`
2. 有序与无序列表 `1. 2.  - * + ... `
3. 区块 `>`
4. 代码块 ```
5. 分割线 `***, ---`


### 行内标签

1. 代码段 ``
2. 粗体 `**s**`
3. 斜体 `*s*`
4. 删除线 `~~s~~`
5. 链接
6. 图片

行内标签处理
```
二阶段
斜体 - italic
粗体 - bold
删除线 - del
代码段 - cs
三阶段
链接 - link
图片 - img

TODO 支持图片、链接
所有状态开始位于阶段1，当遇到相应字符串后进入阶段2或阶段3。
进入阶段2表示确定一个类型的节点，此时需要
1. 创建并记录节点，重制确定的类型状态
2. 重制处于阶段1的状态中，起始位置被当前状态覆盖范围包括的节点
3. 若确定的是代码段、链接、图片，则还需清除已确定但是被覆盖的节点

创建的节点仍然可以使用排序后遍历方式形成节点树，但节点正文内容需要包括链接、图片等其他信息。

```
*sdf**sdf**dsf*

## 预研

### 标题处理

```
创建根节点root
当前啊根节点 s = root
当前处理节点 p
如果为#
    读取至多5个#
    若下一个为空格
        读取所有空格 制表符
        若遇到回车 换行
            创建正文节点，将读取到的内容添加到p
        否则
            若p不为空，将p加入到s中
            p=创建标题节点
            读取到回车 换行
            若s为标题节点且s标题等级小于大于当前 
                s = s->parent 
            循环
            将p加入到s的子集中
            p置为空
    否则-不为空格
        继续读取到回车换行
        将读取到的内容添加到p
如果不为#
    读取到回车换行
    将读取到的内容添加到p

```


## 设计

### 数据结构

最终是将文档变为树的结构，因此数据结构使用不同类型节点表示。只有text节点保存文本数据，其它节点只保存标签信息如标题级数。

1. 节点 - 最终文档树上的节点，包括 父节点，子节点，节点类型，内容
   1. 标题节点 - 多级标题，包括 节点级数
   2. 列表项节点 - 有序/无序列表的每个列表项
   3. 列表节点 - 列表，子节点为列表项，包括 列表类型 - 有序/无序
   4. 区块节点 - 由>组成的区块
   5. 分割线节点 - 分割线
   6. 代码段节点 - 不包含其它子节点
   7. 粗体节点 - 可包含斜体，删除线子节点
   8. 斜体节点 - 可包含粗体、删除线子节点
   9. 删除线节点 - 可包含粗体、斜体子节点
2. 节点类型 - 枚举类，各种类型的节点

*sdf**sdf**sdf*

### 流程

1. 行内标签 - 粗体，斜体，删除线，代码段，图片，链接
   ```
   -------------------
   行为 - 清空状态
       checkPointIndex, checkPointStartPosList
   行为 - 是否到达下一个检查点
       text[i:]以下一个检查点标识串起始 - 可以
       否则 - 不可以
   行为 - 进入下一阶段
       checkPointIndex += 1
       更新checkPointStartPosList
       若 checkPointIndex == maxCheckPoint
           调用每个 onNodeGotListener
   -------------------
   状态完成监听器
       所有
           创建新节点，添加到结果集
           清除当前状态
           清除起始位置≥当前状态起始位置，并且处于非0检查点的状态
       代码段、图片、链接
           删除结果集中，起始位置≥当前状态的节点
   --------------------
   创建状态 - 六个f
   设置状态完成监听器
   i = 0->size
       对每个状态
           可以进入下一阶段
               进入下一阶段
               break
   ---------------------
   斜体 与 粗体: 严格模式，斜体的标识为 *x，即下一个字符必须不为*
   ```
2. 行级标签 - 标题，列表...



   

